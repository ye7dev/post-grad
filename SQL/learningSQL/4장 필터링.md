# 4장 필터링

- where 절에 조건이 세 개 이상일 경우, 두 조건을 하나의 괄호 안에 넣어준다
- <> = ≠
- between A and B
    - 주의: A가 늘 B보다 작아야 함
    - A,B boundary inclusive result
    
    ```sql
    select customer_id, rental_date
    from rental
    where rental_date between '2005-06-14' and '2005-06-16';
    ```
    
    - 문자열 범위
        - between ‘FA’ and ‘FR’이라고 하면 Franklin은 FR보다 더 크다고 인식해서 결과에 포함되지 않음
        - 사용하는 캐릭터셋 문자 정렬 순서 (collation)을 알아야
- x==a OR x==b → IN (a, b)
    
    ```sql
    select title, rating
    from film
    where rating in ('G', 'PG');
    ```
    
- pet이 들어간 제목의 영화는 안전 등급으로 생각해서, 그 등급의 영화를 걸러내기 - subquery
    
    ```sql
    SELECT title, rating
    FROM film
    WHERE rating IN (SELECT rating FROM film WHERE title LIKE '%PET%');
    ```
    
- 와일드카드 사용
    
    
    | 문자 | 일치 |
    | --- | --- |
    | _ | 정확히 한 문자 |
    | % | 개수 상관 없이 모든 문자 (0포함) |
    | like | 검색 표현식 활용  |
- 검색 표현식 사용
    
    
    | 검색 표현식  | 해석  |
    | --- | --- |
    | F% | F로 시작하는 문자열 |
    | %t | t로 끝나는 문자열 |
    | %bas% | bas를 포함하는 문자열 |
    | _ _t_ | 세번째 char = t인 4글자 문자열  |
- 정규표현식 사용
    
    ```sql
    SELECT last_name, first_name
    FROM customer
    WHERE last_name REGEXP '^[QY]';
    ```
    
    - **`^`**: 이 기호는 문자열의 시작을 의미합니다. 즉, 패턴이 문자열의 맨 처음부터 일치해야 함을 나타냅니다.
    - **`[QY]`**: 대괄호는 문자 집합을 나타내며, 이 안에 포함된 어떤 한 문자와 일치할 수 있습니다. 여기서는 'Q' 또는 'Y' 중 하나의 문자와 일치하는 것을 의미합니다.
        
        → 따라서, 정규 표현식 **`^[QY]`**는 문자열의 시작이 'Q' 또는 'Y' 중 하나로 시작해야 한다는 조건을 명시합니다
        
- null 다양한 정의
    - 해당사항 없음 - ATM 기계에서 발생한 거래내역의 직원 ID 열
    - 아직 알려지지 않은 값 - 재직 중인 직원의 퇴사 날짜
    - 정의되지 않은 값 - DB에 추가되지 않은 제품
    - IS NULL 사용해서 따로 체크
        
        ```sql
        SELECt rental_id, customer_id, return_date
        FROM rental
        WHERE return_date IS NOT NULL;
        ```
        
        - = NULL로 조건 주면 반환되는 결과 없다
    - 값이 열에 할당되었는지 확인하려면 is not null 사용
        
        ```sql
        SELECt rental_id, customer_id, return_date
        FROM rental
        WHERE return_date IS NOT NULL;
        ```
        
    - 2005.5~8 사이 반납되지 않은 모든 대여 정보 찾고 싶을 때
        - 해당 기간에 반납되지 않았다
            1. = return date가 NULL이다
            2. 반납되었으나 해당 기간이 아니다 
        - 여기서 NOT BETWEEN 해당 기간만 주면 당연히 NOT NULL 행들만 나옴
        - 1.2.에 대한 모든 행을 뽑고 싶으면 OR로 조건 줘야 함
            
            ```sql
            SELECT rental_id, customer_id, return_date
            FROM rental
            WHERE return_date IS NOT NULL;
            ```
            
- 실습
    - 검색 표현식 앞에는 LIKE를 쓴다
    - last name 두번째 위치에 A가 있고, A 다음에 W가 있는 모든 고객 찾는 쿼리
        
        ```sql
        SELECT customer_id
        FROM customer
        WHERE last_name LIKE '_A%W%';
        ```