# 15ì¥ ë©”íƒ€ ë°ì´í„°

- DB object(í…Œì´ë¸”, ë·°, ì¸ë±ìŠ¤ ë“±) ê´€ë ¨ ì •ë³´ ì €ì¥
- ë©”íƒ€ ë°ì´í„°ì˜ ì €ì¥ ë°©ë²•, ì €ì¥ ìœ„ì¹˜, ì ‘ê·¼ ë°©ë²•, í™œìš©ì•ˆ
- ë°ì´í„°ì— ê´€í•œ ë°ì´í„°
    - ë°ì´í„° ë”•ì…”ë„ˆë¦¬, ì‹œìŠ¤í…œ ì¹´íƒˆë¡œê·¸
        - í…Œì´ë¸” ì´ë¦„
        - í…Œì´ë¸” ìŠ¤í† ë¦¬ì§€ ì •ë³´(í…Œì´ë¸” ìŠ¤í˜ì´ìŠ¤, ì´ˆê¸° í¬ê¸° ë“±)
        - ìŠ¤í† ë¦¬ì§€ ì—”ì§„
        - ì—´ ì´ë¦„
        - ì—´ ë°ì´í„° ìë£Œí˜•
        - ê¸°ë³¸ ì—´ ê°’
        - not null ì—´ ì œì•½ ì¡°ê±´
        - ê¸°ë³¸ í‚¤ ì—´
        - ê¸°ë³¸ í‚¤ ì´ë¦„
        - ê¸°ë³¸ í‚¤ ì¸ë±ìŠ¤ì˜ ì´ë¦„
        - ì¸ë±ìŠ¤ ì´ë¦„
        - ì¸ë±ìŠ¤ ìœ í˜•(b-tree, bitmap)
        - ì¸ë±ìŠ¤ ì—´
        - ì¸ë±ìŠ¤ ì—´ ì •ë ¬ ìˆœì„œ(ì˜¤ë¦„ì°¨ìˆœ, ë‚´ë¦¼ì°¨ìˆœ)
        - ì¸ë±ìŠ¤ ìŠ¤í† ë¦¬ì§€ ì •ë³´
        - ì™¸ë˜ í‚¤ ì´ë¦„
        - ì™¸ë˜ í‚¤ ì—´
        - ì™¸ë˜ í‚¤ ê´€ë ¨ í…Œì´ë¸”/ì—´
- ì •ë³´ ìŠ¤í‚¤ë§ˆ
    - information_schema
        - mySQLì—ì„œ ë©”íƒ€ë°ì´í„°ë¥¼ ê²Œì‹œí•˜ëŠ” íŠ¹ìˆ˜ ë°ì´í„° ë² ì´ìŠ¤
        - ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  ê°ì²´ëŠ” ë·° - ì´ ë·°ë¥¼ ì¿¼ë¦¬í•´ì„œ í”„ë¡œê·¸ë˜ë° ë°©ì‹ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥
    - ì˜ˆ-ìƒ¤í‚¤ë¼ ë°ì´í„° ë² ì´ìŠ¤ì˜ **ëª¨ë“  í…Œì´ë¸”, ë·°** ì´ë¦„ì„ ê²€ìƒ‰
        
        ```sql
        select table_name, table_type
        from information_schema.tables /* ë·° */
        where table_schema = 'sakila'
        order by 1;
        ```
        
        - information_schema.tables
            - í…Œì´ë¸”ê³¼ ë·° ëª¨ë‘ í¬í•¨. ë·°ë¥¼ ì œì™¸í•˜ë ¤ë©´ where ì ˆì— ì¡°ê±´ ì¶”ê°€
                
                `where table_schema = 'sakila' and TABLE_TYPE='BASE TABLE'`
                
            - ë·°ë§Œ ê´€ì‹¬ ìˆì„ ê²½ìš°
                
                ```sql
                select table_name, is_updatable /* table_type ì¹¼ëŸ¼ì€ ì—†ë‹¤ */
                from information_schema.views /* í…Œì´ë¸”ì´ ì•„ë‹ˆë¼ ë·° */
                where table_schema = 'sakila' 
                order by 1;
                ```
                
    - ì˜ˆ-film tableì— ëŒ€í•œ **ì¹¼ëŸ¼** ì •ë³´ ê²€ìƒ‰
        
        ```sql
        select column_name, data_type, character_maximum_length char_max_len, numeric_precision num_prcsn, numeric_scale num_scale
        from information_schema.columns /* ë·° */
        where table_schema = 'sakila' and table_name = 'film'
        order by ordinal_position; /* í…Œì´ë¸”ì— ì¶”ê°€ëœ ìˆœì„œëŒ€ë¡œ ì—´ì„ ê²€ìƒ‰ */
        ```
        
    - ì˜ˆ-rental tableì˜ **ì¸ë±ìŠ¤** ì •ë³´ ê²€ìƒ‰
        
        ```sql
        select index_name, non_unique, seq_in_index, column_name
        from information_schema.statistics /* ë·° */
        where table_schema = 'sakila' and table_name = 'rental'
        order by 1, 3;
        ```
        
    - ì˜ˆ-ìŠ¤í‚¤ë§ˆ ë‚´ì˜ **ì œì•½ ì¡°ê±´** ê²€ìƒ‰
        
        ```sql
        select constraint_name, table_name, constraint_type
        from information_schema.table_constraints /* ë·° */
        where table_schema='sakila'
        order by 3, 1;
        ```
        
    - ì •ë³´ ìŠ¤í‚¤ë§ˆì— ìˆëŠ” ëª¨ë“  ë·°ë¥¼ ë³´ê³  ì‹¶ìœ¼ë©´
        
        ```sql
        SHOW TABLES FROM INFORMATION_SCHEMA;
        ```
        
        - í‘œ 15-1 ì •ë³´ ìŠ¤í‚¤ë§ˆ ë·°
            
            ![1000011492.jpg](15%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%86%E1%85%A6%E1%84%90%E1%85%A1%20%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%20bc296780ee9b44b9a34c0c0cf97f9dcf/1000011492.jpg)
            
- ë©”íƒ€ ë°ì´í„°ë¡œ ì‘ì—…í•˜ê¸°
    - ìŠ¤í‚¤ë§ˆ ìƒì„± ìŠ¤í¬ë¦½íŠ¸
        - ì˜ˆ-ì¹´í…Œê³ ë¦¬ í…Œì´ë¸” ìƒì„±í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸
            
            ```sql
            create table category(
            	category_id tinyint unsigned not null auto_increment,
                name varchar(25) not null,
                last_update timestamp not null default current_timestamp
            		on update current_timestamp,
            	primary key (category_id)
                ) engine=InnoDB default charset=utf8;
            ```
            
            - ìœ„ì˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¹˜ì§€ ì•Šê³  ì¡´ì¬í•˜ëŠ” ì •ë³´ë¥¼ ê²€ìƒ‰í•´ì„œ ê°™ì€ ì„¤ì •ì˜ í…Œì´ë¸” ë§Œë“¤ê¸° (ê·¼ë° ì´ë ‡ê²Œ í•˜ëŠ”ê²Œ ì½”ë“œê°€ ë” ê¸¸ë‹¤;;)
                - information_schema.columns í…Œì´ë¸”ì„ ì¿¼ë¦¬í•´ì„œ í…Œì´ë¸”ì˜ ì¹¼ëŸ¼ì— ëŒ€í•œ ì •ë³´ ê²€ìƒ‰
                    
                    ```sql
                    SELECT 'create table category (' create_table_statement 
                    UNION ALL SELECT 
                        cols.txt
                    FROM
                        (SELECT 
                            CONCAT('  ', column_name, ' ', column_type, CASE
                                    WHEN is_nullable = 'NO' THEN ' not null'
                                    ELSE ''
                                END, CASE
                                    WHEN
                                        extra IS NOT NULL
                                            AND extra LIKE 'default_generated%'
                                    THEN
                                        CONCAT(' default ', column_default, SUBSTR(extra, 18))
                                    WHEN extra IS NOT NULL THEN CONCAT(' ', extra)
                                    ELSE ''
                                END, ',') txt
                        FROM
                            information_schema.columns
                        WHERE
                            table_schema = 'sakila'
                                AND table_name = 'category'
                        ORDER BY ordinal_position) cols 
                    UNION ALL SELECT ')'
                    ```
                    
            - ê¸°ë³¸ í‚¤ ì œì•½ì¡°ê±´ì— ëŒ€í•œ ì •ë³´ë¥¼ ê²€ìƒ‰
                - table_constraint, key_column_usage ë·°ì— ëŒ€í•œ ì¿¼ë¦¬ ì¶”ê°€
                    
                    ```sql
                    SELECT 'create table category (' create_table_statement 
                    UNION ALL SELECT 
                        cols.txt
                    FROM
                        (SELECT 
                            CONCAT('  ', column_name, ' ', column_type, CASE
                                    WHEN is_nullable = 'NO' THEN ' not null'
                                    ELSE ''
                                END, CASE
                                    WHEN
                                        extra IS NOT NULL
                                            AND extra LIKE 'default_generated%'
                                    THEN
                                        CONCAT(' default ', column_default, SUBSTR(extra, 18))
                                    WHEN extra IS NOT NULL THEN CONCAT(' ', extra)
                                    ELSE ''
                                END, ',') txt
                        FROM
                            information_schema.columns
                        WHERE
                            table_schema = 'sakila'
                                AND table_name = 'category'
                        ORDER BY ordinal_position) cols 
                    UNION ALL SELECT 
                        CONCAT('   constraint primary key (')
                    FROM
                        information_schema.table_constraints
                    WHERE
                        table_schema = 'sakila'
                            AND table_name = 'category'
                            AND constraint_type = 'PRIMARY KEY' 
                    UNION ALL SELECT 
                        cols.txt
                    FROM
                        (SELECT 
                            CONCAT(CASE
                                    WHEN ordinal_position > 1 THEN '    , '
                                    ELSE '     '
                                END, column_name) txt
                        FROM
                            information_schema.key_column_usage
                        WHERE
                            table_schema = 'sakila'
                                AND table_name = 'category'
                                AND constraint_name = 'primary'
                        ORDER BY ordinal_position) cols 
                    UNION ALL SELECT '  )' 
                    UNION ALL SELECT ')'
                    ```
                    
                    - ìœ„ì˜ ìŠ¤í¬ë¦½íŠ¸ì˜ ê²°ê³¼ë¬¼ì„ ê°€ì§€ê³  table ìƒì„± í•  ìˆ˜ ìˆìŒ
                        
                        ```sql
                        create table category (
                          category_id tinyint unsigned not null auto_increment,
                          name varchar(25) not null ,
                          last_update timestamp not null default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP,
                           constraint primary key (
                             category_id
                          )
                        )
                        ```
                        
    - ë°°í¬ í™•ì¸
        - ë°°í¬ ì „í›„ì— ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰, ë‘ ê²°ê³¼ì…‹ ì°¨ì´ í™•ì¸
            - ìƒˆ ìŠ¤í‚¤ë§ˆ ê°œì²´ê°€ ì ì ˆí•œ ì—´, ì¸ë±ìŠ¤, ê¸°ë³¸ í‚¤ ë“±ì„ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì¸
            
            ```sql
            select tbl.table_name,
            # ì—´
            (select count(*) from information_schema.columns clm
            	where clm.table_schema = tbl.table_schema
            	and clm.table_name = tbl.table_name) num_columns,
            # ì¸ë±ìŠ¤ 
            (select count(*) from information_schema.statistics sta
            	where sta.table_schema = tbl.table_schema
                and sta.table_name = tbl.table_name) num_indexes,
            # ê¸°ë³¸ í‚¤ 
            (select count(*) from information_schema.table_constraints tc
            	where tc.table_schema = tbl.table_schema
                and tc.table_name = tbl.table_name
                and tc.constraint_type = 'PRIMARY KEY') num_primary_keys
            from information_schema.tables tbl
            # sakila ìŠ¤í‚¤ë§ˆì—ì„œ viewê°€ ì•„ë‹ˆë¼ tableë§Œ ì·¨í•¨ 
            where tbl.table_schema = 'sakila' and tbl.table_type = 'BASE TABLE'
            order by 1;
            ```
            
- ë™ì  SQL ìƒì„±
    - ìë°”ì™€ ê°™ì€ ë‹¤ë¥¸ ì–¸ì–´ì—ëŠ” ê´€ê³„í˜• DBì™€ì˜ ì¸í„°í˜ì´ìŠ¤ ê¸°ëŠ¥ì´ í¬í•¨ë˜ì§€ë§Œ, ë¬¸ë²• ìì²´ì— SQLë¬¸ì„  í¬í•¨í•˜ì§€ëŠ” ì•ŠìŒ
        - ìë°” í‚¤ì›Œë“œë‚˜ ë¬¸ë²•ìœ¼ë¡œ SQL ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ëŠ” ì—†ì§€ë§Œ, stringìœ¼ë¡œ SQLì„ ë°›ì•„ì„œ ì¸í„°í˜ì´ìŠ¤ì— ë³´ë‚¼ ìˆœ ìˆê³ , ì¸í„°í˜ì´ìŠ¤ëŠ” ì´ë ‡ê²Œ ë°›ì€ ë¬¸ìì—´ì„ SQLë¬¸ìœ¼ë¡œ ì½ì–´ì„œ ì‹¤í–‰
    - ë™ì  SQL ì‹¤í–‰
        - SQL ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  DB ì—”ì§„ì— ë¬¸ìì—´ì„ ì „ì†¡í•˜ëŠ” ê²ƒ
        - mySQLì€ ë™ì  ì‹¤í–‰ì„ ìœ„í•œ prepare, execute, deallocate ì œê³µ
            
            ```sql
            # qry ë³€ìˆ˜ì— ë¬¸ìì—´ í• ë‹¹ 
            set @qry = 'select customer_id, first_name, last_name from customer
            ;
            
            # ì¤€ë¹„ êµ¬ë¬¸ -> êµ¬ë¬¸ ë¶„ì„, ë³´ì•ˆ ê²€ì‚¬ ë° ìµœì í™”ë¥¼ ìœ„í•´ DB ì—”ì§„ì— ì œì¶œ 
            prepare dynsql1 from @qry;
            
            # ëª…ë ¹ë¬¸ ì‹¤í–‰ 
            execute dynsql1;
            
            # êµ¬ë¬¸ ë‹«ì•„ì„œ DB ë¦¬ì†ŒìŠ¤ í•´ì œ 
            deallocate prepare dynsql1;
            ```
            
        - ëŸ°íƒ€ì„ ì‹œ ì¡°ê±´ì„ ì§€ì •í•  ìˆ˜ ìˆë„ë¡ ìë¦¬ í‘œì‹œìê°€ í¬í•¨ëœ ì¿¼ë¦¬
            
            ```sql
            set @qry='select customer_id, first_name, last_name from customer where customer_id = ?';
            
            prepare dynsql2 from @qry;
            
            set @custid=9;
            
            execute dynsql2 **using** @custid;
            
            set @custid=145;
            
            execute dynsql2 using @custid;
            
            deallocate prepare dynsql2;
            ```
            
        - viewì—ì„œ ì—´ ì´ë¦„ ê²€ìƒ‰
            - ì™œ ordinal_position=1 ì¡°ê±´ì— maxê°€ ë“¤ì–´ê°€ëƒ?
                
                ```sql
                SELECT max(case when ordinal_position=1 then column_name else null end)
                from information_schema.columns
                where table_schema = 'sakila' and table_name= 'customer'
                group by table_name
                ```
                
                - group by table_nameì„ í–ˆê¸° ë•Œë¬¸ì— maxë¼ëŠ” ì§‘ê³„ í•¨ìˆ˜ë¥¼ ë„£ì–´ì¤€ ë“¯
                    - êµ³ì´ group byì™€ maxë¥¼ ì‚¬ìš©í•œ ì´ìœ ëŠ” ëª¨ë¥´ê² ì§€ë§Œ
                        - ì™œëƒë©´ customerë¼ëŠ” ì´ë¦„ì˜ tableë„ í•˜ë‚˜ê³ , ê±°ê¸°ì„œ ordinal_position=1ì¸ ì¹¼ëŸ¼(ì œì¼ ì²˜ìŒìœ¼ë¡œ ì˜¤ëŠ” ì¹¼ëŸ¼)ë„ í•˜ë‚˜ê¸° ë•Œë¬¸ì—â€¦
                - ì•„ë˜ ì¿¼ë¦¬ë‘ ë™ì¼í•œ ê²°ê³¼ë¥¼ ì¤„ ë¿
                    
                    ```sql
                    SELECT column_name
                    FROM information_schema.columns
                    WHERE table_schema = 'sakila' AND table_name = 'customer' AND ordinal_position = 1;
                    ```
                    
            - qry ë³€ìˆ˜ ìƒì„±
                
                ```sql
                select concat('select ', 
                		concat_ws(',', cols.col1, cols.col2, cols.col3, cols.col4, cols.col5, cols.col6, cols.col7, cols.col8, cols.col9),
                        ' from customer where customer_id = ?')
                into @qry
                from
                	(select
                		max(case when ordinal_position=1 then column_name else null end) col1,
                    max(Case when ordinal_position=2 then column_name else null end) col2, 
                    max(Case when ordinal_position=3 then column_name else null end) col3, 
                    max(Case when ordinal_position=4 then column_name else null end) col4, 
                    max(Case when ordinal_position=5 then column_name else null end) col5, 
                    max(Case when ordinal_position=6 then column_name else null end) col6, 
                    max(Case when ordinal_position=7 then column_name else null end) col7, 
                    max(Case when ordinal_position=8 then column_name else null end) col8, 
                    max(Case when ordinal_position=9 then column_name else null end) col9
                	from information_schema.columns
                    where table_schema = 'sakila' and table_name = 'customer'
                    group by table_name ) cols
                        
                ```
                
                - ê²°ê³¼ (select @qry)
                    
                    select customer_id,store_id,first_name,last_name,email,address_id,active,create_date,last_update from customer where customer_id = ?
                    
            - resource í• ë‹¹(prepare) â†’ ëŒ€ì… ë³€ìˆ˜ ì„¤ì • (set) â†’ ëŒ€ì…í•´ì„œ ì‹¤í–‰ (execute) â†’ resource ë†“ê¸°(deallocate)
                
                ```sql
                prepare dynsql3 from @qry;
                set @custid = 45;
                execute dynsql3 using @custid;
                deallocate prepare dynsql3;
                ```
                
- ì‹¤ìŠµ
    - 1
        
        ```sql
        select distinct table_name, index_name
        from information_schema.statistics
        where table_schema = 'sakila'
        ```
        
        - select ë’¤ì— distinctë¥¼ ë¶™ì—¬ì•¼ ì¤‘ë³µ rowê°€ ë‚˜ì˜¤ì§€ ì•ŠëŠ”ë‹¤
            - distinct ì—†ëŠ” ìƒí™©ì—ì„œ í•œ rowëŠ” í•˜ë‚˜ì˜ tableì— ìˆëŠ” index í•˜ë‚˜ë¥¼ ë‚˜íƒ€ëƒ„
            - ê·¼ë° index í•˜ë‚˜ëŠ” ì—¬ëŸ¬ ì¹¼ëŸ¼ì— ëŒ€í•´ ì§€ì •ë˜ì—ˆì„ ìˆ˜ ìˆìŒ
            - ì´ ê²½ìš° ê° ì»¬ëŸ¼ë§ˆë‹¤ ë³„ë„ì˜ í–‰ì´ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— ì¤‘ë³µëœ ê²ƒì²˜ëŸ¼ ë³´ì´ëŠ” í–‰ì´ ìƒê¹€
    - 2 â¤ï¸â€ğŸ”¥
        - ëª©í‘œ: sakila.customer í…Œì´ë¸”ì˜ ëª¨ë“  ì¸ë±ìŠ¤ë¥¼ ë§Œë“¤ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì¶œë ¥ì„ ìƒì„±í•˜ëŠ” ì¿¼ë¦¬
        - mine(íƒë„ ì—†ë‹¤ ğŸ˜…)
            
            ```sql
            set @qry= 'alter table table_name = ? add index index_name = ? (column_list=?)'
            
            prepare dynsql4 from @qry
            
            set @col_list = 'select table_name, index_name
            from information_schema.statistics
            where table_schema = 'sakila''
            
            execute dynsql4 using @col_list
            deallocate prepare dynsql4
            ```
            
        - [with ì ˆ revisited](https://www.notion.so/Learning-SQL-6f5006f0a7ae4f3e8456a06a399a1456?pvs=21)
            - ê°„ë‹¨ ì˜ˆì‹œ
                
                ```sql
                WITH cte AS (
                    SELECT column1, column2
                    FROM some_table
                    WHERE condition
                )
                SELECT *
                FROM cte
                WHERE another_condition;
                ```
                
                - ì´ê±¸ with ì ˆ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ temporary table ë³„ë„ë¡œ ìƒì„±í•´ì•¼ í•´ì„œ ì¿¼ë¦¬ê°€ ê¸¸ì–´ì§
                    
                    ```sql
                    CREATE TEMPORARY TABLE temp_table AS
                    SELECT column1, column2
                    FROM some_table
                    WHERE condition;
                    
                    SELECT *
                    FROM temp_table
                    WHERE another_condition;
                    
                    DROP TABLE temp_table;
                    ```
                    
        
        ```sql
        /* CTE */
        with idx_info as 
        	(select s1.table_name, s1.index_name, s1.column_name, s1.seq_in_index,
        		(select max(s2.seq_in_index)
                 from information_schema.statistics s2
                 where s2.table_schema = s1.table_schema
        						and s2.table_name = s1.table_name
                    and s2.index_name = s1.index_name) num_columns
        	from information_schema.statistics s1
            where s1.table_schema = 'sakila'
        		and s1.table_name = 'customer')
        		
        /* main query */
        select concat(case when seq_in_index = 1 
        				then concat('alter table ', table_name, ' add index ', index_name, ' (', column_name)
                        else concat('   , ', column_name) end,
        			  case when seq_in_index = num_columns then ');'
        				else '' end) index_creation_statement
        from idx_info
        order by index_name, seq_in_index;
        ```
        
        - CTE ë¶€ë¶„
            - information_schema.statistics
                - ë°ì´í„°ë² ì´ìŠ¤ì˜ ì¸ë±ìŠ¤ì— ëŒ€í•œ í¬ê´„ì ì¸ ì •ë³´ë¥¼ ì œê³µ
                    - ê° í…Œì´ë¸”ì˜ ì¸ë±ìŠ¤ êµ¬ì„±, ì»¬ëŸ¼ ìˆœì„œ, ê³ ìœ ì„±, ì¹´ë””ë„ë¦¬í‹°, ì •ë ¬ ìˆœì„œ ë“±ì˜ ìƒì„¸ ì •ë³´ë¥¼ ì¡°íšŒ
            - seq_in_index ì¹¼ëŸ¼
                - ì¸ë±ìŠ¤ê°€ ì—¬ëŸ¬ ê°œì˜ ì»¬ëŸ¼ìœ¼ë¡œ êµ¬ì„±ëœ ê²½ìš°, `seq_in_index`ëŠ” í•´ë‹¹ ì»¬ëŸ¼ì´ ì¸ë±ìŠ¤ì—ì„œ ëª‡ ë²ˆì§¸ ìœ„ì¹˜ì— ìˆëŠ”ì§€ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
                
                ### ì˜ˆì œ ì„¤ëª…
                
                ```sql
                SELECT table_name, index_name, column_name, seq_in_index
                FROM information_schema.statistics
                WHERE table_name = 'my_table';
                ```
                
                | table_name | index_name | column_name | seq_in_index |
                | --- | --- | --- | --- |
                | my_table | idx_example | column1 | 1 |
                | my_table | idx_example | column2 | 2 |
                
                ### ì˜ë¯¸
                
                - `seq_in_index = 1`: ì´ ì¸ë±ìŠ¤ì—ì„œ `column1`ì´ ì²« ë²ˆì§¸ ìœ„ì¹˜ì— ìˆìŠµë‹ˆë‹¤.
                - `seq_in_index = 2`: ì´ ì¸ë±ìŠ¤ì—ì„œ `column2`ê°€ ë‘ ë²ˆì§¸ ìœ„ì¹˜ì— ìˆìŠµë‹ˆë‹¤.
                
                ì´ ê°’ì€ ì¸ë±ìŠ¤ì˜ ê²€ìƒ‰ ë° ì •ë ¬ ìˆœì„œë¥¼ ê²°ì •í•˜ëŠ” ë° ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤. ì¸ë±ìŠ¤ê°€ ì—¬ëŸ¬ ì»¬ëŸ¼ìœ¼ë¡œ êµ¬ì„±ëœ ê²½ìš°, `seq_in_index`ì˜ ê°’ì´ ì‘ì€ ì»¬ëŸ¼ë¶€í„° ë¨¼ì € ì‚¬ìš©ë©ë‹ˆë‹¤.
                
                ë”°ë¼ì„œ, `seq_in_index`ëŠ” ì¸ë±ìŠ¤ì˜ êµ¬ì¡°ë¥¼ ì´í•´í•˜ê³  ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•´ ì¤‘ìš”í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
                
            - CTEì—ì„œ ì™œ êµ³ì´ ê°™ì€ í…Œì´ë¸”ì— ìƒê´€ ì„œë¸Œì¿¼ë¦¬ë¥¼ ë§Œë“œëŠ”ê°€
                
                ![Untitled](15%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%86%E1%85%A6%E1%84%90%E1%85%A1%20%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%20bc296780ee9b44b9a34c0c0cf97f9dcf/Untitled.png)
                
                - ë§ˆì§€ë§‰ num_columns ì¹¼ëŸ¼ ë³´ë©´ ê° ì¹¼ëŸ¼ì´ ì†í•œ ì¸ë±ìŠ¤ì˜ ìµœëŒ€ ì¹¼ëŸ¼ ìˆ˜ê°€ ê°™ì´ ë‚˜ì™€ ìˆìŒ. ì´ê±´ ì·¨í•© ì •ë³´ë¼ì„œ ë‹¨ìˆœ ì—´ ì¶”ê°€ë¡œëŠ” ì–»ê¸° ì–´ë ¤ìš´ ì •ë³´
        - main query
            - í° í‹€ì€ CTEì—ì„œ ê° í–‰ì— ëŒ€í•´ index_creation_statementë¥¼ ë§Œë“œëŠ” ê²ƒ
                
                ![Untitled](15%E1%84%8C%E1%85%A1%E1%86%BC%20%E1%84%86%E1%85%A6%E1%84%90%E1%85%A1%20%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%20bc296780ee9b44b9a34c0c0cf97f9dcf/Untitled%201.png)
                
            - ì¡°ê±´ë¬¸ ë¶„ê¸°
                - í•œ ì¸ë±ìŠ¤ì— í•œ ì¹¼ëŸ¼ë§Œ ë“¤ì–´ ìˆê±°ë‚˜, ì—¬ëŸ¬ ì¹¼ëŸ¼ì´ ë“¤ì–´ ìˆëŠ” ì¸ë±ìŠ¤ì˜ ì²«ë²ˆì§¸ ì¹¼ëŸ¼ì¸ ê²½ìš° (seq_in_index = 1)
                    - `alter table í…Œì´ë¸” ì´ë¦„ add index ì¸ë±ìŠ¤ ì´ë¦„ (ì¸ë±ìŠ¤ì— ë„£ì„ ì¹¼ëŸ¼ í•˜ë‚˜`
                    - ì™¼ìª½ ê´„í˜¸ëŠ” ì•ˆ ë„£ìŒ
                - ì—¬ëŸ¬ ì¹¼ëŸ¼ì´ í•œ ì¸ë±ìŠ¤ë¥¼ ë§Œë“¤ ë•Œ, ì´ ì¤‘ ì¤‘ê°„ ì¹¼ëŸ¼ì˜ ê²½ìš°
                    - ì¤‘ê°„ì— ì˜¤ëŠ” ì¹¼ëŸ¼ì€ `, ì¹¼ëŸ¼ ì´ë¦„` ë§Œ ìƒì„±
                - í•œ ì¸ë±ìŠ¤ì— í•œ ì¹¼ëŸ¼ë§Œ ë“¤ì–´ ìˆê±°ë‚˜, ì—¬ëŸ¬ ì¹¼ëŸ¼ì´ ë“¤ì–´ ìˆëŠ” ì¸ë±ìŠ¤ì˜ ë§ˆì§€ë§‰ ì¹¼ëŸ¼ì¸ ê²½ìš° (seq_in_index = num_columns)
                    - ë§¨ ìœ„ì—ì„œ ì•ˆ ë„£ì—ˆë˜ `)` ì˜¤ë¥¸ìª½ ê´„í˜¸ ë„£ì–´ì¤Œ
            - ìœ„ì˜ ì˜ˆì‹œì—ì„œ ë³´ë©´ index `idx_full_name` ì˜ ê²½ìš° ë‘ ê°œì˜ ì¹¼ëŸ¼ì´ í•˜ë‚˜ì˜ ì¸ë±ìŠ¤ë¥¼ êµ¬ì„±
                - ì´ ì¤‘ ë‘ë²ˆì§¸ ì¹¼ëŸ¼ì¸ first_nameì€ ë‹¤ìŒ ì¤„ì— ì™€ìˆì§€ë§Œ, ì•ì˜ statementì— ì´ì–´ì§€ëŠ” ë‚´ìš©ì´ë¼ `,` ë¡œ ì‹œì‘. ë§ˆì§€ë§‰ ì¹¼ëŸ¼ì´ë¼ `)` ë„ ë“¤ì–´ê°€ ìˆìŒ