# 1233. [S/W 문제해결 기본] 9일차 - 사칙연산 유효성 검사

Created time: May 3, 2024 5:30 PM
Last edited time: May 3, 2024 10:33 PM

- AC 코드
    
    ```python
    import sys
    sys.stdin = open("temp_input/input.txt", "r")
    
    class Node:
        def __init__(self, key, value=None, left=None, right=None):
            self.key = key
            self.value = value
            self.left = left
            self.right = right
    
    def check_case(node):
        left_res, right_res = None, None
        if node.left:
            left_res = check_case(node.left)
        if node.right:
            right_res = check_case(node.right)
        # child check
        if left_res == 'no' or right_res == 'no':
            return 'no'
    
        # leaf number node
        if left_res is None and right_res is None and node.value not in op_dict:
            return node.value
    
        # valid op node
        if node.value in op_dict:
            if left_res is not None and left_res not in op_dict:
                if right_res is not None and right_res not in op_dict:
                    try:
                        op_dict[node.value](left_res, right_res)
                        return op_dict[node.value](left_res, right_res)
                    except ZeroDivisionError:
                        return 1
        return 'no'
    
    for t in range(1, 11):
        N = int(input())
        nodes = {i: Node(i) for i in range(1, N+1)}
        op_dict = {'*': lambda x, y: x * y,
                   '+': lambda x, y: x + y,
                   '-': lambda x, y: x - y,
                   '/': lambda x, y: x / y}
        for _ in range(N):
            data = input().split()
            left_key, right_key = None, None
            if len(data) == 2:
                key, value = data
            elif len(data) == 3:
                key, value, left_key = data
            else:
                key, value, left_key, right_key = data
    
            key = int(key)
            nodes[key].value = value if value in op_dict else int(value)
            nodes[key].left = nodes[int(left_key)] if left_key is not None else None
            nodes[key].right = nodes[int(right_key)] if right_key is not None else None
    
        ans = check_case(nodes[1])
        if ans == 'no':
            print(f'#{t} {0}')
        else:
            print(f'#{t} {1}')
    
    ```
    
- Trial
    - 예제 1개만 답이 다르다 흑흑
    
    ```python
    import sys
    sys.stdin = open("temp_input/input.txt", "r")
    
    class Node:
        def __init__(self, key, value=None, left=None, right=None):
            self.key = key
            self.value = value
            self.left = left
            self.right = right
    
    def check_case(node):
        left_res, right_res = None, None
        if node.left:
            left_res = check_case(node.left)
        if node.right:
            right_res = check_case(node.right)
    
        # impossible child
        if left_res == 'no' or right_res == 'no':
            return 'no'
    
        # leaf number node
        if not left_res or not right_res:
            if node.value not in op_dict:
                return node.value
            else:
                return 'no'
    
        # operation
        if node.value in op_dict:
            # op to op -> x
            if left_res in op_dict or right_res in op_dict:
                return 'no'
            else:  # num, num -> op
                return op_dict[node.value](left_res, right_res)
    
    for t in range(1, 11):
        N = int(input())
        print(N)
        nodes = {i: Node(i) for i in range(1, N+1)}
        op_dict = {'*': lambda x, y: x * y,
                   '+': lambda x, y: x + y,
                   '-': lambda x, y: x - y,
                   '/': lambda x, y: x / y}
        for _ in range(N):
            data = input().split()
            left_key, right_key = None, None
            if len(data) == 2:
                key, value = data
            elif len(data) == 3:
                key, value, left_key = data
            else:
                key, value, left_key, right_key = data
    
            key = int(key)
            nodes[key].value = value if value in op_dict else int(value)
            nodes[key].left = nodes[int(left_key)] if left_key is not None else None
            nodes[key].right = nodes[int(right_key)] if right_key is not None else None
    
        ans = check_case(nodes[1])
        if ans == 'no':
            print(f'#{t} {0}')
        else:
            print(f'#{t} {1}')
    
    ```